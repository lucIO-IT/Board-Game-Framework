<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        html, body, .main {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
            background-color: white;
            position: relative;
            overflow: hidden;
        }
        game-map {
            position: absolute;
            top: 0;
            left: 20%;
            margin: 20px;
            border: 3px solid black;
            border-radius: 3%;
            -webkit-border-radius: 3%;
            -moz-border-radius: 3%;
            overflow: hidden;
            z-index: 1;
        }

        .panel {
            width: 250px;
            height: 100%;
            background-color: antiquewhite;
        }

        .ul {
            padding: 0;
            margin: 0;
        }

        .ul li {
            padding: 0;
            margin: 0;
        }

        .left {
            float: left;
        }

        .right {
            float: right;
        }

        .box {
            padding: 20px;
        }

    </style>
</head>
<body>
<div id="app"></div>
<div class="main">
    <game-map width="850" height="600">
        <panel-info 
            width="250" 
            slot="panel-info" 
            content="
                <li></li>
                <li></li>
                <li></li>
                <li></li>
            " 
            url="" 
            style="display: none;">
        </panel-info>
        <panel-faction
                width="850"
                height="150"
                slot="panel-faction"
                details='{"name":"Kingdom of Sicily","symbol":"sc/symbols/sicily.png"}'>
        </panel-faction>
    </game-map>
</div>




<!--
<script type="module" src="prova.js"></script>    
-->
<script type="module" src="engine/core/widgets.js"></script>
<script type="module" src="engine/game_map.js"></script>
<!--
<script>
const objF = (o,f) => Object.keys(o).filter(f);
const objK = (o,f) => Object.keys(o).forEach(f);
const objL = o => Object.keys(o).length;
class DataModel {
    constructor(...restArgs) {
        this.args = this.__checkData__(restArgs);
        this.token = Math.random().toString(36).substr(2);
    }

    __checkData__(a){
        const args = Array.from(a)[0];
        if (!args.name){
            throw 'Attention: name is not defined';
        } else {
            return args;
        }
    }

    __name__(){
        return this.args.name;
    }

    __cleanName__(){
        //Clean special characters from name att
        return this.__name__().replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi, '');
    }

    __getId__(){
        //Return obj ID
        return `${this.__cleanName__()}_${this.token}`;
    }

    __saveItem__(){
        //Create and Overwrite JSON item in localStorage
        const data = JSON.stringify(this.args);
        const id = this.__getId__();
        localStorage.setItem(id, data);
    }

    __loadItem__(){
        //Load item as JSON from localStorage
        const id = this.__getId__();
        return localStorage.getItem(id);
    }

    __deleteItem__(){
        //Delete item from localStorage
        const id = this.__getId__();
        localStorage.removeItem(id);
    }

    static __loadDB__(){
        return window.localStorage;
    }

}

class Region extends DataModel {
    constructor(args){
        super(args);
    }
}

let r = new Region({
    name: 'prova',
    color: 'rgb(88,88,88)',
    leader: {
        name: 'Otto',
        age: 38,
        sons: ['Lukas']
    }
});

objK(DataModel.__loadDB__(), e => localStorage.removeItem(e));
console.log(DataModel.__loadDB__());

/*
class GameModel {

    constructor(name, src, cls, actions, width='0', height='0'){
        this.name = name;
        this.src = src;
        this.css_class = cls;
        this.width = width;
        this.height = height;
        this.actions = actions;
    }

    registerActions(args){
        args.forEach(arg => {
            let els = Array.from(document.getElementsByClassName(arg.cls));
            if (arg.pointer){
                els.forEach(ev => ev.addEventListener(arg.pointer, arg.action), false);
            } else {
                els.forEach(e => arg.action(e));
            }
        });
    }

    __init__(){
        return this.name;
    }

    __render__(target){
        const gm = document.createElement('DIV');
        gm.id = this.name;
        gm.style = `width:${this.width}; height:${this.height};`;
        gm.classList.add(this.css_class);
        gm.innerHTML = `<img class="img-background" src="${this.src}"/>`;
        document.querySelector(target).appendChild(gm);
        this.registerActions(this.actions);
    }
}

const g_actions = [{
        cls: 'gabbiano',
        pointer: 'click',
        action: (e, self) => console.log(`${e.target} ${this}`)
    }
];

let Node = new GameModel('prova', 'images.jpg', 'gabbiano', g_actions, width='60px', height='60px')
Node.__init__();
//Node.__render__();
console.log(Node.actions);

class GameMap extends GameModel {
    constructor(name, src, cls, actions, width='100%', height='100%'){
        super(name, src, cls, actions, width, height);
    }
}

let Map = new GameMap('prova', 'images.jpg', 'gabbiano', g_actions)
Map.__render__('#ciao');
Map.__init__();

class PlayerModel {
    constructor(name, human=false, score=0){
        this.name = name;
        this.human = human;
        this.score = score;
    }

    __init__(){
        return this.name;
    }

    __playerType__(){
        if (this.human){
            return 'is human player';
        } else {
            return 'is ia player';
        }
    }

    __render__(){
        return `${this.__init__()} ${this.__playerType__()} and has score: ${this.score}`;
    }

}

let PM = new PlayerModel('alb');
console.log(PM.__render__());
*/
</script>
-->

</body>
</html>